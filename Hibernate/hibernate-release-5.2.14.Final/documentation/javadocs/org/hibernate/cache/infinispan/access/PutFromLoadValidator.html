<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_152) on Tue Feb 27 12:02:50 GMT 2018 -->
<title>PutFromLoadValidator (Hibernate JavaDocs)</title>
<meta name="date" content="2018-02-27">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PutFromLoadValidator (Hibernate JavaDocs)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":9,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":9,"i12":10,"i13":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PutFromLoadValidator.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/hibernate/cache/infinispan/access/NonTxPutFromLoadInterceptor.html" title="class in org.hibernate.cache.infinispan.access"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.Lock.html" title="class in org.hibernate.cache.infinispan.access"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/hibernate/cache/infinispan/access/PutFromLoadValidator.html" target="_top">Frames</a></li>
<li><a href="PutFromLoadValidator.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.hibernate.cache.infinispan.access</div>
<h2 title="Class PutFromLoadValidator" class="title">Class PutFromLoadValidator</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.hibernate.cache.infinispan.access.PutFromLoadValidator</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">PutFromLoadValidator</span>
extends java.lang.Object</pre>
<div class="block">Encapsulates logic to allow a <a href="../../../../../org/hibernate/cache/infinispan/access/InvalidationCacheAccessDelegate.html" title="class in org.hibernate.cache.infinispan.access"><code>InvalidationCacheAccessDelegate</code></a> to determine
 whether a <a href="../../../../../org/hibernate/cache/infinispan/access/InvalidationCacheAccessDelegate.html#putFromLoad-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-java.lang.Object-long-java.lang.Object-boolean-"><code>InvalidationCacheAccessDelegate.putFromLoad(org.hibernate.engine.spi.SharedSessionContractImplementor, Object, Object, long, Object, boolean)</code></a>
 call should be allowed to update the cache. A <code>putFromLoad</code> has
 the potential to store stale data, since the data may have been removed from the
 database and the cache between the time when the data was read from the database
 and the actual call to <code>putFromLoad</code>.
 <p>
 The expected usage of this class by a thread that read the cache and did
 not find data is:
 <p/>
 <ol>
 <li> Call <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#registerPendingPut-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>registerPendingPut(SharedSessionContractImplementor, Object, long)</code></a></li>
 <li> Read the database</li>
 <li> Call <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a>
 <li> if above returns <code>null</code>, the thread should not cache the data;
 only if above returns instance of <code>AcquiredLock</code>, put data in the cache and...</li>
 <li> then call <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#releasePutFromLoadLock-java.lang.Object-org.hibernate.cache.infinispan.access.PutFromLoadValidator.Lock-"><code>releasePutFromLoadLock(Object, Lock)</code></a></li>
 </ol>
 </p>
 <p/>
 <p>
 The expected usage by a thread that is taking an action such that any pending
 <code>putFromLoad</code> may have stale data and should not cache it is to either
 call
 <p/>
 <ul>
 <li> <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#beginInvalidatingKey-java.lang.Object-java.lang.Object-"><code>beginInvalidatingKey(Object, Object)</code></a> (for a single key invalidation)</li>
 <li>or <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#beginInvalidatingRegion--"><code>beginInvalidatingRegion()</code></a> followed by <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#endInvalidatingRegion--"><code>endInvalidatingRegion()</code></a>
     (for a general invalidation all pending puts)</li>
 </ul>
 After transaction commit (when the DB is updated) <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#endInvalidatingKey-java.lang.Object-java.lang.Object-"><code>endInvalidatingKey(Object, Object)</code></a> should
 be called in order to allow further attempts to cache entry.
 </p>
 <p/>
 <p>
 This class also supports the concept of "naked puts", which are calls to
 <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a> without a preceding <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#registerPendingPut-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>registerPendingPut(SharedSessionContractImplementor, Object, long)</code></a>.
 Besides not acquiring lock in <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#registerPendingPut-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>registerPendingPut(SharedSessionContractImplementor, Object, long)</code></a> this can happen when collection
 elements are loaded after the collection has not been found in the cache, where the elements
 don't have their own table but can be listed as 'select ... from Element where collection_id = ...'.
 Naked puts are handled according to txTimestamp obtained by calling <a href="../../../../../org/hibernate/cache/spi/RegionFactory.html#nextTimestamp--"><code>RegionFactory.nextTimestamp()</code></a>
 before the transaction is started. The timestamp is compared with timestamp of last invalidation end time
 and the write to the cache is denied if it is lower or equal.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.Lock.html" title="class in org.hibernate.cache.infinispan.access">PutFromLoadValidator.Lock</a></span></code>
<div class="block">Marker for lock acquired in <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a></div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#PutFromLoadValidator-org.infinispan.AdvancedCache-org.hibernate.cache.infinispan.InfinispanRegionFactory-">PutFromLoadValidator</a></span>(org.infinispan.AdvancedCache&nbsp;cache,
                    <a href="../../../../../org/hibernate/cache/infinispan/InfinispanRegionFactory.html" title="class in org.hibernate.cache.infinispan">InfinispanRegionFactory</a>&nbsp;regionFactory)</code>
<div class="block">Creates a new put from load validator instance.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#PutFromLoadValidator-org.infinispan.AdvancedCache-org.hibernate.cache.infinispan.InfinispanRegionFactory-org.infinispan.manager.EmbeddedCacheManager-">PutFromLoadValidator</a></span>(org.infinispan.AdvancedCache&nbsp;cache,
                    <a href="../../../../../org/hibernate/cache/infinispan/InfinispanRegionFactory.html" title="class in org.hibernate.cache.infinispan">InfinispanRegionFactory</a>&nbsp;regionFactory,
                    org.infinispan.manager.EmbeddedCacheManager&nbsp;cacheManager)</code>
<div class="block">Creates a new put from load validator instance.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.Lock.html" title="class in org.hibernate.cache.infinispan.access">PutFromLoadValidator.Lock</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-">acquirePutFromLoadLock</a></span>(<a href="../../../../../org/hibernate/engine/spi/SharedSessionContractImplementor.html" title="interface in org.hibernate.engine.spi">SharedSessionContractImplementor</a>&nbsp;session,
                      java.lang.Object&nbsp;key,
                      long&nbsp;txTimestamp)</code>
<div class="block">Acquire a lock giving the calling thread the right to put data in the
 cache for the given key.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#addToCache-org.infinispan.AdvancedCache-org.hibernate.cache.infinispan.access.PutFromLoadValidator-">addToCache</a></span>(org.infinispan.AdvancedCache&nbsp;cache,
          <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html" title="class in org.hibernate.cache.infinispan.access">PutFromLoadValidator</a>&nbsp;validator)</code>
<div class="block">Besides the call from constructor, this should be called only from tests when mocking the validator.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#beginInvalidatingKey-java.lang.Object-java.lang.Object-">beginInvalidatingKey</a></span>(java.lang.Object&nbsp;lockOwner,
                    java.lang.Object&nbsp;key)</code>
<div class="block">Invalidates any <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#registerPendingPut-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>previously registered pending puts</code></a>
 and disables further registrations ensuring a subsequent call to <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a>
 will return <code>false</code>.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#beginInvalidatingRegion--">beginInvalidatingRegion</a></span>()</code>
<div class="block">Invalidates all <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#registerPendingPut-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>previously registered pending puts</code></a> ensuring a subsequent call to
 <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a> will return <code>false</code>.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#beginInvalidatingWithPFER-java.lang.Object-java.lang.Object-java.lang.Object-">beginInvalidatingWithPFER</a></span>(java.lang.Object&nbsp;lockOwner,
                         java.lang.Object&nbsp;key,
                         java.lang.Object&nbsp;valueForPFER)</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#endInvalidatingKey-java.lang.Object-java.lang.Object-">endInvalidatingKey</a></span>(java.lang.Object&nbsp;lockOwner,
                  java.lang.Object&nbsp;key)</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#endInvalidatingKey-java.lang.Object-java.lang.Object-boolean-">endInvalidatingKey</a></span>(java.lang.Object&nbsp;lockOwner,
                  java.lang.Object&nbsp;key,
                  boolean&nbsp;doPFER)</code>
<div class="block">Called after the transaction completes, allowing caching of entries.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#endInvalidatingRegion--">endInvalidatingRegion</a></span>()</code>
<div class="block">Called when the region invalidation is finished.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#registerPendingPut-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-">registerPendingPut</a></span>(<a href="../../../../../org/hibernate/engine/spi/SharedSessionContractImplementor.html" title="interface in org.hibernate.engine.spi">SharedSessionContractImplementor</a>&nbsp;session,
                  java.lang.Object&nbsp;key,
                  long&nbsp;txTimestamp)</code>
<div class="block">Notifies this validator that it is expected that a database read followed by a subsequent <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a> call will occur.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#registerRemoteInvalidation-java.lang.Object-java.lang.Object-">registerRemoteInvalidation</a></span>(java.lang.Object&nbsp;key,
                          java.lang.Object&nbsp;lockOwner)</code>&nbsp;</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#releasePutFromLoadLock-java.lang.Object-org.hibernate.cache.infinispan.access.PutFromLoadValidator.Lock-">releasePutFromLoadLock</a></span>(java.lang.Object&nbsp;key,
                      <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.Lock.html" title="class in org.hibernate.cache.infinispan.access">PutFromLoadValidator.Lock</a>&nbsp;lock)</code>
<div class="block">Releases the lock previously obtained by a call to
 <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a>.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>static <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html" title="class in org.hibernate.cache.infinispan.access">PutFromLoadValidator</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#removeFromCache-org.infinispan.AdvancedCache-">removeFromCache</a></span>(org.infinispan.AdvancedCache&nbsp;cache)</code>
<div class="block">This methods should be called only from tests; it removes existing validator from the cache structures
 in order to replace it with new one.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#resetCurrentSession--">resetCurrentSession</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#setCurrentSession-org.hibernate.engine.spi.SharedSessionContractImplementor-">setCurrentSession</a></span>(<a href="../../../../../org/hibernate/engine/spi/SharedSessionContractImplementor.html" title="interface in org.hibernate.engine.spi">SharedSessionContractImplementor</a>&nbsp;session)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="PutFromLoadValidator-org.infinispan.AdvancedCache-org.hibernate.cache.infinispan.InfinispanRegionFactory-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PutFromLoadValidator</h4>
<pre>public&nbsp;PutFromLoadValidator(org.infinispan.AdvancedCache&nbsp;cache,
                            <a href="../../../../../org/hibernate/cache/infinispan/InfinispanRegionFactory.html" title="class in org.hibernate.cache.infinispan">InfinispanRegionFactory</a>&nbsp;regionFactory)</pre>
<div class="block">Creates a new put from load validator instance.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cache</code> - Cache instance on which to store pending put information.</dd>
</dl>
</li>
</ul>
<a name="PutFromLoadValidator-org.infinispan.AdvancedCache-org.hibernate.cache.infinispan.InfinispanRegionFactory-org.infinispan.manager.EmbeddedCacheManager-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PutFromLoadValidator</h4>
<pre>public&nbsp;PutFromLoadValidator(org.infinispan.AdvancedCache&nbsp;cache,
                            <a href="../../../../../org/hibernate/cache/infinispan/InfinispanRegionFactory.html" title="class in org.hibernate.cache.infinispan">InfinispanRegionFactory</a>&nbsp;regionFactory,
                            org.infinispan.manager.EmbeddedCacheManager&nbsp;cacheManager)</pre>
<div class="block">Creates a new put from load validator instance.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cache</code> - Cache instance on which to store pending put information.</dd>
<dd><code>regionFactory</code> - </dd>
<dd><code>cacheManager</code> - where to find a cache to store pending put information</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="addToCache-org.infinispan.AdvancedCache-org.hibernate.cache.infinispan.access.PutFromLoadValidator-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addToCache</h4>
<pre>public static&nbsp;void&nbsp;addToCache(org.infinispan.AdvancedCache&nbsp;cache,
                              <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html" title="class in org.hibernate.cache.infinispan.access">PutFromLoadValidator</a>&nbsp;validator)</pre>
<div class="block">Besides the call from constructor, this should be called only from tests when mocking the validator.</div>
</li>
</ul>
<a name="removeFromCache-org.infinispan.AdvancedCache-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeFromCache</h4>
<pre>public static&nbsp;<a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html" title="class in org.hibernate.cache.infinispan.access">PutFromLoadValidator</a>&nbsp;removeFromCache(org.infinispan.AdvancedCache&nbsp;cache)</pre>
<div class="block">This methods should be called only from tests; it removes existing validator from the cache structures
 in order to replace it with new one.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cache</code> - </dd>
</dl>
</li>
</ul>
<a name="setCurrentSession-org.hibernate.engine.spi.SharedSessionContractImplementor-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setCurrentSession</h4>
<pre>public&nbsp;void&nbsp;setCurrentSession(<a href="../../../../../org/hibernate/engine/spi/SharedSessionContractImplementor.html" title="interface in org.hibernate.engine.spi">SharedSessionContractImplementor</a>&nbsp;session)</pre>
</li>
</ul>
<a name="resetCurrentSession--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resetCurrentSession</h4>
<pre>public&nbsp;void&nbsp;resetCurrentSession()</pre>
</li>
</ul>
<a name="acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>acquirePutFromLoadLock</h4>
<pre>public&nbsp;<a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.Lock.html" title="class in org.hibernate.cache.infinispan.access">PutFromLoadValidator.Lock</a>&nbsp;acquirePutFromLoadLock(<a href="../../../../../org/hibernate/engine/spi/SharedSessionContractImplementor.html" title="interface in org.hibernate.engine.spi">SharedSessionContractImplementor</a>&nbsp;session,
                                                        java.lang.Object&nbsp;key,
                                                        long&nbsp;txTimestamp)</pre>
<div class="block">Acquire a lock giving the calling thread the right to put data in the
 cache for the given key.
 <p>
 <strong>NOTE:</strong> A call to this method that returns <code>true</code>
 should always be matched with a call to <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#releasePutFromLoadLock-java.lang.Object-org.hibernate.cache.infinispan.access.PutFromLoadValidator.Lock-"><code>releasePutFromLoadLock(Object, Lock)</code></a>.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>session</code> - </dd>
<dd><code>key</code> - the key</dd>
<dd><code>txTimestamp</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>AcquiredLock</code> if the lock is acquired and the cache put
         can proceed; <code>null</code> if the data should not be cached</dd>
</dl>
</li>
</ul>
<a name="releasePutFromLoadLock-java.lang.Object-org.hibernate.cache.infinispan.access.PutFromLoadValidator.Lock-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releasePutFromLoadLock</h4>
<pre>public&nbsp;void&nbsp;releasePutFromLoadLock(java.lang.Object&nbsp;key,
                                   <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.Lock.html" title="class in org.hibernate.cache.infinispan.access">PutFromLoadValidator.Lock</a>&nbsp;lock)</pre>
<div class="block">Releases the lock previously obtained by a call to
 <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - the key</dd>
</dl>
</li>
</ul>
<a name="beginInvalidatingRegion--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>beginInvalidatingRegion</h4>
<pre>public&nbsp;boolean&nbsp;beginInvalidatingRegion()</pre>
<div class="block">Invalidates all <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#registerPendingPut-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>previously registered pending puts</code></a> ensuring a subsequent call to
 <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a> will return <code>false</code>. <p> This method will block until any
 concurrent thread that has <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquired the putFromLoad lock</code></a> for the any key has
 released the lock. This allows the caller to be certain the putFromLoad will not execute after this method returns,
 possibly caching stale data. </p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if the invalidation was successful; <code>false</code> if a problem occurred (which the
         caller should treat as an exception condition)</dd>
</dl>
</li>
</ul>
<a name="endInvalidatingRegion--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>endInvalidatingRegion</h4>
<pre>public&nbsp;void&nbsp;endInvalidatingRegion()</pre>
<div class="block">Called when the region invalidation is finished.</div>
</li>
</ul>
<a name="registerPendingPut-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>registerPendingPut</h4>
<pre>public&nbsp;void&nbsp;registerPendingPut(<a href="../../../../../org/hibernate/engine/spi/SharedSessionContractImplementor.html" title="interface in org.hibernate.engine.spi">SharedSessionContractImplementor</a>&nbsp;session,
                               java.lang.Object&nbsp;key,
                               long&nbsp;txTimestamp)</pre>
<div class="block">Notifies this validator that it is expected that a database read followed by a subsequent <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a> call will occur. The intent is this method would be called following a cache miss
 wherein it is expected that a database read plus cache put will occur. Calling this method allows the validator to
 treat the subsequent <code>acquirePutFromLoadLock</code> as if the database read occurred when this method was
 invoked. This allows the validator to compare the timestamp of this call against the timestamp of subsequent removal
 notifications.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>session</code> - </dd>
<dd><code>key</code> - key that will be used for subsequent cache put</dd>
<dd><code>txTimestamp</code> - </dd>
</dl>
</li>
</ul>
<a name="beginInvalidatingKey-java.lang.Object-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>beginInvalidatingKey</h4>
<pre>public&nbsp;boolean&nbsp;beginInvalidatingKey(java.lang.Object&nbsp;lockOwner,
                                    java.lang.Object&nbsp;key)</pre>
<div class="block">Invalidates any <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#registerPendingPut-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>previously registered pending puts</code></a>
 and disables further registrations ensuring a subsequent call to <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquirePutFromLoadLock(SharedSessionContractImplementor, Object, long)</code></a>
 will return <code>false</code>. <p> This method will block until any concurrent thread that has
 <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#acquirePutFromLoadLock-org.hibernate.engine.spi.SharedSessionContractImplementor-java.lang.Object-long-"><code>acquired the putFromLoad lock</code></a> for the given key
 has released the lock. This allows the caller to be certain the putFromLoad will not execute after this method
 returns, possibly caching stale data. </p>
 After this transaction completes, <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#endInvalidatingKey-java.lang.Object-java.lang.Object-"><code>endInvalidatingKey(Object, Object)</code></a> needs to be called }</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - key identifying data whose pending puts should be invalidated</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if the invalidation was successful; <code>false</code> if a problem occurred (which the
         caller should treat as an exception condition)</dd>
</dl>
</li>
</ul>
<a name="beginInvalidatingWithPFER-java.lang.Object-java.lang.Object-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>beginInvalidatingWithPFER</h4>
<pre>public&nbsp;boolean&nbsp;beginInvalidatingWithPFER(java.lang.Object&nbsp;lockOwner,
                                         java.lang.Object&nbsp;key,
                                         java.lang.Object&nbsp;valueForPFER)</pre>
</li>
</ul>
<a name="endInvalidatingKey-java.lang.Object-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>endInvalidatingKey</h4>
<pre>public&nbsp;boolean&nbsp;endInvalidatingKey(java.lang.Object&nbsp;lockOwner,
                                  java.lang.Object&nbsp;key)</pre>
</li>
</ul>
<a name="endInvalidatingKey-java.lang.Object-java.lang.Object-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>endInvalidatingKey</h4>
<pre>public&nbsp;boolean&nbsp;endInvalidatingKey(java.lang.Object&nbsp;lockOwner,
                                  java.lang.Object&nbsp;key,
                                  boolean&nbsp;doPFER)</pre>
<div class="block">Called after the transaction completes, allowing caching of entries. It is possible that this method
 is called without previous invocation of <a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.html#beginInvalidatingKey-java.lang.Object-java.lang.Object-"><code>beginInvalidatingKey(Object, Object)</code></a>, then it should be a no-op.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>lockOwner</code> - owner of the invalidation - transaction or thread</dd>
<dd><code>key</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a name="registerRemoteInvalidation-java.lang.Object-java.lang.Object-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>registerRemoteInvalidation</h4>
<pre>public&nbsp;boolean&nbsp;registerRemoteInvalidation(java.lang.Object&nbsp;key,
                                          java.lang.Object&nbsp;lockOwner)</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PutFromLoadValidator.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/hibernate/cache/infinispan/access/NonTxPutFromLoadInterceptor.html" title="class in org.hibernate.cache.infinispan.access"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/hibernate/cache/infinispan/access/PutFromLoadValidator.Lock.html" title="class in org.hibernate.cache.infinispan.access"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/hibernate/cache/infinispan/access/PutFromLoadValidator.html" target="_top">Frames</a></li>
<li><a href="PutFromLoadValidator.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &copy; 2001-2018 <a href="http://redhat.com">Red Hat, Inc.</a>  All Rights Reserved.</small></p>
</body>
</html>
